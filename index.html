<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <title>Warta Jemaat Digital</title>
</head>

<body>

  <div id="loader-overlay">
    <div class="spinner"></div>
    <div class="loading-text">Memuat Warta...</div>
  </div>

  <div class="viewport">

    <div class="book-container">
      <div class="flipbook">
        <!-- Cover Depan -->
        <div class="hard"><img src="images/cover1.webp" alt="" /></div>

        <!-- Cover Dalam Depan (Akan dihapus di Mobile) -->
        <div class="hard inside-cover"><img src="images/coverin1.webp" alt="" /></div>

        <!-- Halaman Isi -->
        <div><img src="images/page1.webp" alt="" /></div>
        <div><img src="images/page2.webp" alt="" /></div>
        <div><img src="images/page3.webp" alt="" /></div>
        <div><img src="images/page4.webp" alt="" /></div>
        <div><img src="images/page5.webp" alt="" /></div>
        <div><img src="images/page6.webp" alt="" /></div>
        <div><img src="images/page7.webp" alt="" /></div>
        <div><img src="images/page8.webp" alt="" /></div>
        <div><img src="images/page9.webp" alt="" /></div>
        <div><img src="images/page10.webp" alt="" /></div>
        <div><img src="images/page11.webp" alt="" /></div>
        <div><img src="images/page12.webp" alt="" /></div>

        <!-- Cover Dalam Belakang (Akan dihapus di Mobile) -->
        <div class="hard inside-cover"><img src="images/coverin2.webp" alt="" /></div>

        <!-- Cover Belakang -->
        <div class="hard"><img src="images/cover2.webp" alt="" /></div>
      </div>
    </div>
  </div>

  <div class="controls">
    <button class="btn" id="prevBtn"><i class="fa-solid fa-chevron-left"></i></button>
    <button class="btn" id="zoomOut"><i class="fa-solid fa-minus"></i></button>
    <button class="btn" id="zoomIn"><i class="fa-solid fa-plus"></i></button>
    <button class="btn" id="nextBtn"><i class="fa-solid fa-chevron-right"></i></button>
  </div>

  <script src="jquery.js"></script>
  <script src="turn.js"></script>

  <script>
    $(window).on('load', function () {

      var flipbook = $(".flipbook");
      var loader = $("#loader-overlay");

      
      flipbook.turn({
        width: 960,
        height: 680,
        autoCenter: true,
        acceleration: true,
        gradients: true,
        elevation: 50,
        duration: 1000,

        // LOGIKA SWITCH SHADOW UTAMA
        when: {
          turning: function (e, page, view) {
            updateShadows(page);
          }
        }
      });

      function resizeViewport() {
        var width = $(window).width();
        var height = $(window).height();

        if (width < 768) {
          // MODE MOBILE
          var mobileWidth = width * 0.95;
          var mobileHeight = mobileWidth * 1.414;
          if (mobileHeight > height * 0.9) {
            mobileHeight = height * 0.9;
            mobileWidth = mobileHeight / 1.414;
          }
          flipbook.turn("display", "single");
          flipbook.turn("size", mobileWidth, mobileHeight);
          $(".book-container").css("transform", "scale(1)");

          // Di HP Shadow dimatikan via CSS media query

        } else {
          // MODE DESKTOP
          var deskWidth = 960;
          var deskHeight = 680;
          if (width < 1100) {
            var scale = width / 1200;
            $(".book-container").css("transform", "scale(" + scale + ")");
          } else {
            $(".book-container").css("transform", "scale(1)");
          }
          flipbook.turn("display", "double");
          flipbook.turn("size", deskWidth, deskHeight);

          // Update ulang shadow sesuai halaman saat ini
          updateShadows(flipbook.turn("page"));
        }
      }

      resizeViewport();
      $(window).resize(resizeViewport);

      setTimeout(function () {
        loader.fadeOut(500, function () {
          flipbook.addClass("loaded");
        });
      }, 500);

      $("#prevBtn").click(function () { flipbook.turn("previous"); });
      $("#nextBtn").click(function () { flipbook.turn("next"); });

      var currentZoom = 1;
      $("#zoomIn").click(function () {
        currentZoom += 0.1;
        $(".book-container").css("transform", "scale(" + currentZoom + ")");
      });
      $("#zoomOut").click(function () {
        if (currentZoom > 0.5) {
          currentZoom -= 0.1;
          $(".book-container").css("transform", "scale(" + currentZoom + ")");
        }
      });

      $(document).keydown(function (e) {
        if (e.keyCode == 37) flipbook.turn('previous');
        if (e.keyCode == 39) flipbook.turn('next');
      });

    });
     $(document).ready(function() {
    
    // --- LOGIC HAPUS COVER DALAM UNTUK MOBILE ---
    var screenWidth = $(window).width();

    // Jika lebar layar <= 767px (Mobile)
    if (screenWidth <= 767) {
        // Hapus elemen yang memiliki kelas 'inside-cover'
        $('.flipbook .inside-cover').remove();
        
        // Optional: Tambahkan logika lain khusus mobile jika perlu
        console.log("Mobile mode: Inside covers removed.");
    }
    // ----------------------------------------------

    // --- INISIALISASI TURN.JS (PENTING: Letakkan setelah logika hapus) ---
    $(".flipbook").turn({
        width: 960,       // Lebar buku (Desktop)
        height: 680,      // Tinggi buku (Desktop)
        elevation: 50,
        gradients: true,
        autoCenter: true,
        duration: 1000,
        
        // Responsif: Jika di mobile, ubah ukuran bukunya
        when: {
            turning: function(e, page, view) {
                // Logika saat membalik halaman...
            }
        }
    });

    // Responsif CSS untuk Turn.js saat resize window
    $(window).bind('keydown', function(e){
        if (e.keyCode==37)
            $(".flipbook").turn("previous");
        else if (e.keyCode==39)
            $(".flipbook").turn("next");
    });

});
  </script>
</body>

</html>